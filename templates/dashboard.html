<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Dashboard - Employee Suite</title>
    <!-- Shopify App Bridge - Latest version with proper initialization -->
    <script src="https://cdn.shopify.com/shopifycloud/app-bridge.js"></script>
    <script src="https://cdn.shopify.com/shopifycloud/app-bridge/latest/environments/production.js"></script>

    <!-- Shopify Polaris Design System -->
    <link rel="stylesheet" href="https://unpkg.com/@shopify/polaris@10.0.0/build/esm/styles.css" />
    <script src="https://unpkg.com/@shopify/polaris@10.0.0/build/esm/polaris.min.js"></script>
    <script>
        // Initialize App Bridge - moved to external JS file
        window.appBridgeReady = false;
        window.isEmbedded = !!new URLSearchParams(window.location.search).get('host');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Critical: Prevent any blocking - render immediately -->
    <style>
        /* Inline critical CSS - no blocking */
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }
    </style>
    <!-- Defer non-critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <!-- Shopify Polaris CSS - only load in embedded mode -->
    <script>
        // App Bridge CSS removed - it's optional and the file doesn't exist at the CDN URL
        // App Bridge JavaScript provides all necessary functionality without CSS
    </script>
    <!-- External Stylesheet -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    <style>
        /* Critical overrides only */
        body {
            margin: 0;
            padding: 0;
        }

        /* Hide header when embedded */
        body.embedded .header {
            display: none !important;
        }

        body.embedded footer {
            display: none !important;
        }
    </style>

    <!-- Consolidated App Bridge moved to top of head -->

    <!-- Google Analytics - Load after page renders -->
    <script>
        // Defer analytics loading
        window.addEventListener("load", function () {
            var script = document.createElement("script");
            script.async = true;
            script.src =
                "https://www.googletagmanager.com/gtag/js?id=G-RBBQ4X7FJ3";
            document.head.appendChild(script);

            script.onload = function () {
                window.dataLayer = window.dataLayer || [];
                function gtag() {
                    dataLayer.push(arguments);
                }
                gtag("js", new Date());
                gtag("config", "G-RBBQ4X7FJ3");
            };
        });
    </script>

    <!-- Meta tags for better SEO and sharing -->
    <meta name="description"
        content="Monitor your Shopify store operations with order tracking, inventory management, and revenue analytics." />
    <meta name="keywords" content="shopify, automation, inventory, orders, analytics, ecommerce" />
    <meta property="og:title" content="Employee Suite - Shopify Automation Platform" />
    <meta property="og:description"
        content="Automate order processing, inventory management, and revenue reporting for your Shopify store." />
    <meta property="og:type" content="website" />
    <script>
        // Navigation helper - moved to external JS file
        // Placeholder for compatibility
    </script>
</head>

<body>
    <div class="header">
        <div class="header-content">
            <a href="#" onclick="
                        openPage('/dashboard');
                        return false;
                    " style="
                        text-decoration: none;
                        color: inherit;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                        font-weight: 600;
                    " class="logo">
                <span>Employee Suite</span>
            </a>
            <div class="header-nav">
                <div class="quick-menu">
                    <button class="quick-menu-btn" onclick="toggleQuickMenu(event)">
                        ‚ö° Quick Access
                    </button>
                    <div class="quick-menu-dropdown" id="quickMenu">
                        <a href="#" onclick="
                                    openPage('/features/csv-exports');
                                    return false;
                                " class="quick-menu-item">
                            <span class="quick-menu-item-icon">üì•</span>
                            CSV Exports
                            <span class="quick-menu-shortcut">‚åòE</span>
                        </a>
                        <a href="#" onclick="
                                    openPage('/features/scheduled-reports');
                                    return false;
                                " class="quick-menu-item">
                            <span class="quick-menu-item-icon">üìÖ</span>
                            Scheduled Reports
                            <span class="quick-menu-shortcut">‚åòS</span>
                        </a>
                        <a href="#" onclick="
                                    openPage('/features/dashboard');
                                    return false;
                                " class="quick-menu-item">
                            <span class="quick-menu-item-icon">üìä</span>
                            Comprehensive Dashboard
                            <span class="quick-menu-shortcut">‚åòD</span>
                        </a>
                        <a href="#" onclick="
                                    openPage('/features/welcome');
                                    return false;
                                " class="quick-menu-item">
                            <span class="quick-menu-item-icon">üéâ</span>
                            New Features
                        </a>
                        <div style="
                                    border-top: 1px solid #e1e3e5;
                                    margin: 8px 0;
                                "></div>
                        <a href="#" onclick="
                                    openPage('/settings/shopify');
                                    return false;
                                " class="quick-menu-item">
                            <span class="quick-menu-item-icon">‚öôÔ∏è</span>
                            Settings
                            <span class="quick-menu-shortcut">‚åò,</span>
                        </a>
                        <a href="#" onclick="
                                    openPage('/subscribe');
                                    return false;
                                " class="quick-menu-item">
                            <span class="quick-menu-item-icon">üí≥</span>
                            Subscribe
                        </a>
                    </div>
                </div>
                <a href="#" onclick="
                            openPage('/settings/shopify');
                            return false;
                        " class="nav-btn">Settings</a>
                <a href="#" onclick="
                            openPage('/subscribe');
                            return false;
                        " class="nav-btn nav-btn-primary">Subscribe</a>
                <a href="/logout" class="nav-btn">Logout</a>
            </div>
        </div>
    </div>

    <div class="page-wrapper">
        <div class="container">
            <div class="dashboard-header-row">
                <div>
                    <div class="page-title">Dashboard</div>
                    <div class="page-subtitle">
                        Monitor your Shopify store operations with inventory
                        tracking, order monitoring, and comprehensive revenue
                        analytics. 7-day free trial, no setup fees.
                    </div>
                    <div style="
                            margin-top: 16px;
                            display: flex;
                            gap: 12px;
                            flex-wrap: wrap;
                        ">
                        <a href="#" onclick="
                                openPage('/features/welcome');
                                return false;
                            " class="btn-primary">
                            üéâ Explore New Features ‚Üí
                        </a>
                        <a href="#" onclick="
                                openPage('/features/csv-exports');
                                return false;
                            " class="btn-secondary">
                            üì• Export Data
                        </a>
                        <a href="#" onclick="
                                openPage('/features/dashboard');
                                return false;
                            " class="btn-secondary">
                            üìä Full Dashboard
                        </a>
                    </div>
                </div>
                {% if is_subscribed %}
                <div style="
                        background: #fff;
                        border: 1px solid #e5e5e5;
                        border-radius: 16px;
                        padding: 16px 20px;
                        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
                        text-align: center;
                        min-width: 140px;
                    ">
                    <div style="
                            font-size: 11px;
                            color: #737373;
                            font-weight: 600;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                            margin-bottom: 4px;
                        ">
                        Subscribed
                    </div>
                    <div style="
                            font-size: 20px;
                            font-weight: 700;
                            color: #0a0a0a;
                        ">
                        ‚úì Active
                    </div>
                </div>
                {% endif %}
            </div>

            {% if not has_access %}
            <div class="banner banner-warning" style="justify-content: space-between; align-items: center">
                <div class="banner-content">
                    <h3>Subscription Required</h3>
                    <p>
                        Your trial has ended. Subscribe now to continue using
                        Employee Suite.
                    </p>
                </div>
                <a href="#" onclick="
                        openPage('/subscribe');
                        return false;
                    " class="banner-action">Subscribe Now</a>
            </div>
            {% elif trial_active and not is_subscribed %}
            <div class="banner banner-warning" style="justify-content: space-between; align-items: center">
                <div class="banner-content">
                    <h3>
                        ‚è∞ Trial Active - {{ days_left }} day{{ 's' if days_left
                        != 1 else '' }} remaining
                    </h3>
                    <p>
                        Subscribe now to keep access when your trial ends. No
                        credit card required until trial ends.
                    </p>
                </div>
                <a href="{{ url_for('billing.subscribe') }}" class="banner-action">Subscribe Now ‚Üí</a>
            </div>
            {% endif %} {% if has_shopify and quick_stats.has_data and
            is_subscribed %}
            <!-- PREMIUM: PROPRIETARY FORECASTING ENGINE ($99/mo Value) -->
            <div id="executive-insights" style="
                    margin-bottom: 32px;
                    display: none;
                    animation: fadeIn 0.6s ease-out;
                ">
                <div style="
                        background: linear-gradient(
                            135deg,
                            #0f172a 0%,
                            #1e293b 100%
                        );
                        color: white;
                        border-radius: 16px;
                        padding: 24px;
                        box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.3);
                        position: relative;
                        overflow: hidden;
                        border: 1px solid rgba(255, 255, 255, 0.05);
                    ">
                    <!-- Background decoration -->
                    <div style="
                            position: absolute;
                            top: -50px;
                            right: -50px;
                            width: 300px;
                            height: 300px;
                            background: radial-gradient(
                                circle,
                                rgba(99, 102, 241, 0.2) 0%,
                                rgba(0, 0, 0, 0) 70%
                            );
                            pointer-events: none;
                        "></div>
                    <div style="
                            position: absolute;
                            bottom: -50px;
                            left: -50px;
                            width: 200px;
                            height: 200px;
                            background: radial-gradient(
                                circle,
                                rgba(16, 185, 129, 0.1) 0%,
                                rgba(0, 0, 0, 0) 70%
                            );
                            pointer-events: none;
                        "></div>

                    <div style="
                            display: flex;
                            justify-content: space-between;
                            align-items: flex-start;
                            position: relative;
                            z-index: 2;
                            flex-wrap: wrap;
                            gap: 20px;
                        ">
                        <div>
                            <div style="
                                    display: flex;
                                    align-items: center;
                                    gap: 8px;
                                    margin-bottom: 12px;
                                ">
                                <span style="
                                        background: rgba(99, 102, 241, 0.2);
                                        color: #a5b4fc;
                                        font-size: 11px;
                                        font-weight: 700;
                                        padding: 4px 8px;
                                        border-radius: 4px;
                                        text-transform: uppercase;
                                        letter-spacing: 1px;
                                        border: 1px solid
                                            rgba(99, 102, 241, 0.3);
                                    ">AI Forecast</span>
                                <span style="
                                        color: #94a3b8;
                                        font-size: 13px;
                                        font-weight: 500;
                                    ">Inventory Intelligence
                            </div>
                        </div>
                        <h2 style="
                                    font-size: 24px;
                                    font-weight: 700;
                                    color: white;
                                    margin-bottom: 8px;
                                    letter-spacing: -0.5px;
                                    line-height: 1.2;
                                ">
                            Stockout Risk Detected
                        </h2>
                        <p style="
                                    color: #cbd5e1;
                                    font-size: 14px;
                                    max-width: 550px;
                                    line-height: 1.6;
                                ">
                            Our predictive engine analyzed your recent sales
                            velocity.
                            <strong id="risk-count" style="color: white; font-weight: 600">-- items</strong>
                            are projected to run out of stock within the
                            next 7 days.
                        </p>
                    </div>
                    <div style="
                                text-align: right;
                                background: rgba(0, 0, 0, 0.2);
                                padding: 12px 16px;
                                border-radius: 12px;
                                border: 1px solid rgba(255, 255, 255, 0.05);
                            ">
                        <div style="
                                    font-size: 12px;
                                    color: #94a3b8;
                                    margin-bottom: 4px;
                                    font-weight: 500;
                                ">
                            Potential Revenue Loss
                        </div>
                        <div id="risk-revenue" style="
                                    font-size: 28px;
                                    font-weight: 700;
                                    color: #f87171;
                                    letter-spacing: -1px;
                                    line-height: 1;
                                ">
                            --
                        </div>
                    </div>
                </div>

                <!-- Risk Items Table -->
                <div style="
                            margin-top: 24px;
                            background: rgba(255, 255, 255, 0.03);
                            border-radius: 12px;
                            overflow: hidden;
                            border: 1px solid rgba(255, 255, 255, 0.05);
                        ">
                    <div style="
                                padding: 12px 16px;
                                background: rgba(255, 255, 255, 0.02);
                                border-bottom: 1px solid
                                    rgba(255, 255, 255, 0.05);
                                font-size: 11px;
                                text-transform: uppercase;
                                letter-spacing: 1px;
                                color: #64748b;
                                font-weight: 600;
                                display: flex;
                                justify-content: space-between;
                            ">
                        <span>High Risk Items</span>
                        <span>Projection</span>
                    </div>
                    <div id="risk-list" style="display: flex; flex-direction: column">
                        <!-- JS injected items here -->
                        <div style="
                                    text-align: center;
                                    color: #94a3b8;
                                    font-size: 13px;
                                    padding: 20px;
                                ">
                            Analyzing sales patterns...
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            // AI Forecast functionality moved to external JS file
        </script>
        {% endif %} {% if has_shopify and quick_stats.has_data and
        is_subscribed %}
        <div style="
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 16px;
                    margin-bottom: 32px;
                    animation: fadeIn 0.5s ease-in;
                ">
            <div class="stat-card">
                <div style="
                            font-size: 13px;
                            color: #737373;
                            font-weight: 600;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                            margin-bottom: 12px;
                            display: flex;
                            align-items: center;
                            gap: 6px;
                        ">
                    <span>üì¶</span>
                    <span>Pending Orders</span>
                </div>
                <div style="
                            font-size: 40px;
                            font-weight: 800;
                            color: #0a0a0a;
                            line-height: 1;
                            margin-bottom: 8px;
                        ">
                    {{ quick_stats.pending_orders or 0 }}
                </div>
                <div style="font-size: 13px; color: #737373">
                    Need your attention
                </div>
            </div>
            <div style="
                        background: linear-gradient(
                            135deg,
                            #fff 0%,
                            #fafafa 100%
                        );
                        border: 1px solid #e5e5e5;
                        border-radius: 16px;
                        padding: 24px;
                        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
                        transition: all 0.3s ease;
                    ">
                <div style="
                            font-size: 13px;
                            color: #737373;
                            font-weight: 600;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                            margin-bottom: 12px;
                            display: flex;
                            align-items: center;
                            gap: 6px;
                        ">
                    <span>üìä</span>
                    <span>Total Products</span>
                </div>
                <div style="
                            font-size: 40px;
                            font-weight: 800;
                            color: #0a0a0a;
                            line-height: 1;
                            margin-bottom: 8px;
                        ">
                    {{ quick_stats.total_products or 0 }}
                </div>
                <div style="font-size: 13px; color: #737373">
                    In your store
                </div>
            </div>
            <div style="
                        background: linear-gradient(
                            135deg,
                            #fff 0%,
                            #fafafa 100%
                        );
                        border: 1px solid #e5e5e5;
                        border-radius: 16px;
                        padding: 24px;
                        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
                        transition: all 0.3s ease;
                    ">
                <div style="
                            font-size: 13px;
                            color: #737373;
                            font-weight: 600;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                            margin-bottom: 12px;
                            display: flex;
                            align-items: center;
                            gap: 6px;
                        ">
                    <span>‚ö†Ô∏è</span>
                    <span>Low Stock</span>
                </div>
                <div
                    style="font-size: 40px; font-weight: 800; color: {% if quick_stats.low_stock_items > 0 %}#dc2626{% else %}#16a34a{% endif %}; line-height: 1; margin-bottom: 8px;">
                    {{ quick_stats.low_stock_items or 0 }}
                </div>
                <div style="font-size: 13px; color: #737373;">
                    {% if quick_stats.low_stock_items and quick_stats.low_stock_items > 0 %}Need restocking{% else %}All good{% endif %}
                </div>
            </div>
        </div>
        {% endif %} {% if not has_shopify %}
        <div class="banner banner-info" style="
                    background: #ffffff;
                    border: 1px solid #e1e3e5;
                    border-left: 3px solid #008060;
                ">
            <div class="banner-content" style="flex: 1">
                <h3 style="
                            margin-bottom: 8px;
                            font-size: 16px;
                            font-weight: 600;
                            color: #202223;
                        ">
                    Connect your Shopify store
                </h3>
                <p style="
                            margin-bottom: 0;
                            font-size: 14px;
                            color: #6d7175;
                        ">
                    Get started in 30 seconds. Connect your store to unlock
                    order monitoring, inventory management, and revenue
                    analytics.
                </p>
            </div>
            <a href="#" onclick="
                        openPage('/settings/shopify');
                        return false;
                    " class="banner-action">Connect Store ‚Üí</a>
        </div>
        {% endif %}

        <div class="cards-grid">
            <div class="card">
                <div class="card-icon">üì¶</div>
                <div class="card-title">Order Processing</div>
                <div class="card-description">
                    View pending and unfulfilled Shopify orders. Monitor
                    order status and payment information.
                </div>
                {% if has_access %}
                <button type="button" class="card-btn" data-action="processOrders" onclick="
                            if (window.processOrders)
                                window.processOrders(this);
                        " aria-label="View pending orders">
                    <span>View Orders</span>
                    <span style="font-size: 12px; opacity: 0.8">‚Üí</span>
                </button>
                {% else %}
                <button type="button" class="card-btn" onclick="showSubscribePrompt()"
                    style="opacity: 0.6; cursor: not-allowed" disabled aria-label="Subscribe to view orders">
                    <span>View Orders</span>
                    <span style="font-size: 12px; opacity: 0.8">‚Üí</span>
                </button>
                {% endif %}
            </div>

            <div class="card">
                <div class="card-icon">üìä</div>
                <div class="card-title">Inventory Management</div>
                <div class="card-description">
                    Monitor stock levels across all products. Get low-stock
                    alerts and complete inventory visibility.
                </div>
                {% if has_access %}
                <button type="button" class="card-btn" data-action="updateInventory" onclick="
                            if (window.updateInventory)
                                window.updateInventory(this);
                        " aria-label="Check inventory levels">
                    <span>Check Inventory</span>
                    <span style="font-size: 12px; opacity: 0.8">‚Üí</span>
                </button>
                {% else %}
                <button type="button" class="card-btn" onclick="showSubscribePrompt()"
                    style="opacity: 0.6; cursor: not-allowed" disabled aria-label="Subscribe to check inventory">
                    <span>Check Inventory</span>
                    <span style="font-size: 12px; opacity: 0.8">‚Üí</span>
                </button>
                {% endif %}
            </div>

            <div class="card">
                <div class="card-icon">üí∞</div>
                <div class="card-title">Revenue Analytics</div>
                <div class="card-description">
                    Generate revenue reports with product-level breakdown
                    and insights.
                </div>
                {% if has_access %}
                <button type="button" class="card-btn" data-action="generateReport" onclick="
                            if (window.generateReport)
                                window.generateReport(this);
                        " aria-label="Generate revenue report">
                    <span>Generate Report</span>
                    <span style="font-size: 12px; opacity: 0.8">‚Üí</span>
                </button>
                {% else %}
                <button type="button" class="card-btn" onclick="showSubscribePrompt()"
                    style="opacity: 0.6; cursor: not-allowed" disabled aria-label="Subscribe to generate reports">
                    <span>Generate Report</span>
                    <span style="font-size: 12px; opacity: 0.8">‚Üí</span>
                </button>
                {% endif %}
            </div>

            <div class="card" style="
                        border: 2px solid #008060;
                        background: linear-gradient(
                            135deg,
                            #ffffff 0%,
                            #f0fdf4 100%
                        );
                    ">
                <div style="
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            margin-bottom: 8px;
                        ">
                    <div class="card-icon">üì•</div>
                    <span style="
                                background: #008060;
                                color: white;
                                padding: 2px 8px;
                                border-radius: 4px;
                                font-size: 11px;
                                font-weight: 600;
                            ">NEW</span>
                </div>
                <div class="card-title">CSV Exports</div>
                <div class="card-description">
                    Download Orders, Inventory, and Revenue reports as CSV
                    with date filtering. Export your data anytime.
                </div>
                {% if has_access %}
                <a href="/features/csv-exports{% if shop %}?shop={{ shop }}{% if host %}&host={{ host }}{% endif %}{% endif %}"
                    class="card-btn" style="
                            text-decoration: none;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            background: #008060;
                            color: white;
                        ">
                    <span>Export Data</span>
                    <span style="font-size: 12px; opacity: 0.9">‚Üí</span>
                </a>
                {% else %}
                <a href="/features/welcome{% if shop %}?shop={{ shop }}{% if host %}&host={{ host }}{% endif %}{% endif %}"
                    class="card-btn" style="
                            text-decoration: none;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            background: #008060;
                            color: white;
                        ">
                    <span>Learn More</span>
                    <span style="font-size: 12px; opacity: 0.9">‚Üí</span>
                </a>
                {% endif %}
            </div>

            <div class="card" style="
                        border: 2px solid #008060;
                        background: linear-gradient(
                            135deg,
                            #ffffff 0%,
                            #f0fdf4 100%
                        );
                    ">
                <div style="
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            margin-bottom: 8px;
                        ">
                    <div class="card-icon">üìÖ</div>
                    <span style="
                                background: #008060;
                                color: white;
                                padding: 2px 8px;
                                border-radius: 4px;
                                font-size: 11px;
                                font-weight: 600;
                            ">NEW</span>
                </div>
                <div class="card-title">Scheduled Reports</div>
                <div class="card-description">
                    Automatically receive reports via Email or SMS at your
                    preferred time. Set it and forget it.
                </div>
                {% if has_access %}
                <a href="/features/scheduled-reports{% if shop %}?shop={{ shop }}{% if host %}&host={{ host }}{% endif %}{% endif %}"
                    class="card-btn" style="
                            text-decoration: none;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            background: #008060;
                            color: white;
                        ">
                    <span>Schedule Reports</span>
                    <span style="font-size: 12px; opacity: 0.9">‚Üí</span>
                </a>
                {% else %}
                <a href="/features/welcome{% if shop %}?shop={{ shop }}{% if host %}&host={{ host }}{% endif %}{% endif %}"
                    class="card-btn" style="
                            text-decoration: none;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            background: #008060;
                            color: white;
                        ">
                    <span>Learn More</span>
                    <span style="font-size: 12px; opacity: 0.9">‚Üí</span>
                </a>
                {% endif %}
            </div>

            <div class="card" style="
                        border: 2px solid #008060;
                        background: linear-gradient(
                            135deg,
                            #ffffff 0%,
                            #f0fdf4 100%
                        );
                    ">
                <div style="
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            margin-bottom: 8px;
                        ">
                    <div class="card-icon">üìä</div>
                    <span style="
                                background: #008060;
                                color: white;
                                padding: 2px 8px;
                                border-radius: 4px;
                                font-size: 11px;
                                font-weight: 600;
                            ">NEW</span>
                </div>
                <div class="card-title">Comprehensive Dashboard</div>
                <div class="card-description">
                    View all three reports (Orders, Inventory, Revenue) in
                    one unified dashboard view.
                </div>
                {% if has_access %}
                <a href="/features/dashboard{% if shop %}?shop={{ shop }}{% if host %}&host={{ host }}{% endif %}{% endif %}"
                    class="card-btn" style="
                            text-decoration: none;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            background: #008060;
                            color: white;
                        ">
                    <span>View Dashboard</span>
                    <span style="font-size: 12px; opacity: 0.9">‚Üí</span>
                </a>
                {% else %}
                <a href="/features/welcome{% if shop %}?shop={{ shop }}{% if host %}&host={{ host }}{% endif %}{% endif %}"
                    class="card-btn" style="
                            text-decoration: none;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            background: #008060;
                            color: white;
                        ">
                    <span>Learn More</span>
                    <span style="font-size: 12px; opacity: 0.9">‚Üí</span>
                </a>
                {% endif %}
            </div>
        </div>

        <div id="connection-status" style="display: none; margin-bottom: 16px"></div>
        <div class="output-container">
            <div class="output-header">Results</div>
            <div id="output"></div>
        </div>
    </div>

    <script>
        // Essential inline JavaScript - most functionality moved to external file
        
        function showSubscribePrompt() {
            document.getElementById('output').innerHTML = `
                <div style="padding: 40px; background: #fff; border-radius: 16px; border: 1px solid #e5e7eb; text-align: center; animation: fadeIn 0.3s ease-in; max-width: 500px; margin: 0 auto; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);">
                    <div style="margin-bottom: 20px; display: inline-flex; align-items: center; justify-content: center; width: 64px; height: 64px; background: #FEF2F2; border-radius: 50%;">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#DC2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                        </svg>
                    </div>
                    <h3 style="color: #111827; margin-bottom: 8px; font-size: 20px; font-weight: 700;">Subscription Required</h3>
                    <p style="color: #6B7280; margin-bottom: 24px; font-size: 15px; line-height: 1.5;">This feature is available with Employee Suite Pro. Subscribe to unlock full access.</p>
                    <a href="/subscribe?shop={{ shop }}{% if host %}&host={{ host }}{% endif %}" style="display: inline-block; background: #2563EB; color: #fff; padding: 12px 24px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 15px; transition: all 0.2s; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);">Upgrade Now ‚Üí</a>
                    <p style="color: #9CA3AF; margin-top: 16px; font-size: 13px;">$39/month ‚Ä¢ 7-day money-back guarantee</p>
                </div>
            `;
        }

        // Quick Menu Toggle
        function toggleQuickMenu(event) {
            event.stopPropagation();
            var menu = document.getElementById('quickMenu');
            if (menu) {
                menu.classList.toggle('show');
            }
        }

    </script>

    <!-- Load external dashboard JavaScript -->
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>

    <script>
        // Close quick menu when clicking outside
        document.addEventListener('click', function(e) {
            var menu = document.getElementById('quickMenu');
            var btn = e.target.closest('.quick-menu-btn');
            if (menu && !btn && !e.target.closest('.quick-menu-dropdown')) {
                menu.classList.remove('show');
            }
        });
            </script>

            <footer style="
                margin-top: 64px;
                padding: 32px 24px;
                border-top: 1px solid #e1e3e5;
                text-align: center;
                background: #ffffff;
            ">
                <div style="max-width: 1200px; margin: 0 auto">
                    <div style="
                        display: flex;
                        justify-content: center;
                        gap: 20px;
                        flex-wrap: wrap;
                        font-size: 14px;
                        margin-bottom: 16px;
                    ">
                        <a href="/faq" style="
                            color: #6d7175;
                            text-decoration: none;
                            font-weight: 400;
                            transition: color 0.15s;
                        ">FAQ</a>
                        <span style="color: #e1e3e5">|</span>
                        <a href="/privacy" style="
                            color: #6d7175;
                            text-decoration: none;
                            font-weight: 400;
                            transition: color 0.15s;
                        ">Privacy Policy</a>
                        <span style="color: #e1e3e5">|</span>
                        <a href="/terms" style="
                            color: #6d7175;
                            text-decoration: none;
                            font-weight: 400;
                            transition: color 0.15s;
                        ">Terms of Service</a>
                    </div>
                    <div style="color: #8c9196; font-size: 13px; font-weight: 400">
                        ¬© 2026 Employee Suite. All rights reserved.
                    </div>
                </div>
            </footer>
            <script>
            // Ensure any critical closing scripts are here
            </script>
            </div> <!-- End .container -->
            </div> <!-- End .page-wrapper -->
</body>

</html>
